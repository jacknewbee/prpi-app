"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5043],{5043:function(n,r,e){e.r(r),e.d(r,{default:function(){return G}});var t,o,c,i,a,s=e(70865),u=e(87394),l=e(92228),d=e(52322),h=e(16816),f=e(73921),b=e(3411),p=e(80751),g=e(33080),k=e(5406),v=e(96914),x=e(32301),m=e(63093),Z=e(38497),N=e(98788),B=e(45680),y=e(2784),j=e(6647),w=e(72305),S=e(80173),I=e(11885);function O(){var n=(0,l.Z)(['\n            query getNftMarketSubgraphHealth {\n              indexingStatusForCurrentVersion(subgraphName: "','") {\n                health\n                chains {\n                  chainHeadBlock {\n                    number\n                  }\n                  latestBlock {\n                    number\n                  }\n                }\n              }\n            }\n          ']);return O=function(){return n},n}(t=o||(o={}))[t.OK=0]="OK",t[t.WARNING=1]="WARNING",t[t.NOT_OK=2]="NOT_OK",t[t.UNKNOWN=3]="UNKNOWN";var P=function(n){var r=(0,u.Z)((0,y.useState)({status:o.UNKNOWN,currentBlock:0,chainHeadBlock:0,latestBlock:0,blockDifference:0}),2),e=r[0],t=r[1];return(0,I.X)(function(r){var e;(e=(0,N.Z)(function(){var e,c,i,a,s,l,d,h,f;return(0,B.__generator)(this,function(b){switch(b.label){case 0:return b.trys.push([0,2,,3]),[4,Promise.all([(0,j.request)(S.AM,(0,j.gql)(O(),n)),r?Promise.resolve(r):w.v.getBlockNumber()])];case 1:return c=(e=u.Z.apply(void 0,[b.sent(),2]))[0].indexingStatusForCurrentVersion,i=e[1],a="healthy"===c.health,s=parseInt(c.chains[0].chainHeadBlock.number),d=i-(l=parseInt(c.chains[0].latestBlock.number)),h=i-s,!a||d>200||h>200?t({status:o.NOT_OK,currentBlock:i,chainHeadBlock:s,latestBlock:l,blockDifference:d}):d>50||h>50?t({status:o.WARNING,currentBlock:i,chainHeadBlock:s,latestBlock:l,blockDifference:d}):t({status:o.OK,currentBlock:i,chainHeadBlock:s,latestBlock:l,blockDifference:d}),[3,3];case 2:return f=b.sent(),console.error("Failed to perform health check for ".concat(n," subgraph"),f),[3,3];case 3:return[2]}})}),function(){return e.apply(this,arguments)})()},[n]),e};function C(){var n=(0,l.Z)(["\n  border-radius: 8px;\n  > div {\n    border-radius: 8px;\n  }\n  user-select: none;\n"]);return C=function(){return n},n}function D(){var n=(0,l.Z)(["\n  gap: 7px;\n"]);return D=function(){return n},n}function K(){var n=(0,l.Z)(["\n  width: 12px;\n  height: 12px;\n  border-radius: 50%;\n  background: ",";\n"]);return K=function(){return n},n}var _=(0,b.ZP)(p.Z).withConfig({componentId:"sc-46961c6e-0"})(C()),W=(0,b.ZP)(g.Z).withConfig({componentId:"sc-46961c6e-1"})(D()),A=(0,b.ZP)(k.ZP).withConfig({componentId:"sc-46961c6e-2"})(K(),function(n){var r=n.$color;return n.theme.colors[r]}),R=function(n){var r=n.color,e=n.label,t=n.description,o=n.currentBlock,c=n.secondRemainingBlockSync,i=n.blockNumberFromSubgraph,a=(0,f.$G)().t;return(0,d.jsxs)(k.ZP,{children:[(0,d.jsxs)(W,{pb:"10px",children:[(0,d.jsx)(A,{$color:r}),(0,d.jsx)(x.Z,{children:e})]}),(0,d.jsx)(x.Z,{pb:"24px",children:t}),(0,d.jsxs)(x.Z,{children:[(0,d.jsxs)("strong",{children:[a("Chain Head Block"),":"]})," ",o]}),(0,d.jsxs)(x.Z,{children:[(0,d.jsxs)("strong",{children:[a("Latest Subgraph Block"),":"]})," ",i]}),(0,d.jsxs)(x.Z,{children:[(0,d.jsxs)("strong",{children:[a("Delay"),":"]})," ",o-i," (",c,"s)"]})]})},G=function(n){var r=n.subgraphName,e=n.inline,t=n.customDescriptions,l=n.obeyGlobalSetting,b=(0,f.$G)().t,p=P(r),g=p.status,N=p.currentBlock,B=p.blockDifference,y=p.latestBlock,j=(0,u.Z)((0,Z.YF)(),1)[0],w=g===o.WARNING||g===o.NOT_OK,S={delayed:{label:b("Delayed"),color:"failure",description:null!==(c=null==t?void 0:t.delayed)&&void 0!==c?c:b("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},slow:{label:b("Slight delay"),color:"warning",description:null!==(i=null==t?void 0:t.slow)&&void 0!==i?i:b("Subgraph is currently experiencing delays due to BSC issues. Performance may suffer until subgraph is restored.")},healthy:{label:b("Fast"),color:"success",description:null!==(a=null==t?void 0:t.healthy)&&void 0!==a?a:b("No issues with the subgraph.")}},I=B*h.hJ,O=S[g===o.NOT_OK?"delayed":g===o.WARNING?"slow":"healthy"],C=(0,v.Z)((0,d.jsx)(R,(0,s.Z)({currentBlock:N,secondRemainingBlockSync:I,blockNumberFromSubgraph:y},O)),{placement:"top"}),D=C.targetRef,K=C.tooltipVisible,G=C.tooltip;return y&&N&&((void 0===l||l)&&j||w)?e?(0,d.jsxs)(W,{alignItems:"center",justifyContent:"flex-end",ref:D,children:[(0,d.jsx)(A,{$color:O.color}),(0,d.jsx)(x.Z,{children:O.label}),(0,d.jsx)(m.Z,{}),K&&G]}):(0,d.jsxs)(k.ZP,{position:"fixed",bottom:"calc(55px + env(safe-area-inset-bottom))",right:"5%",ref:D,"data-test":"subgraph-health-indicator",children:[K&&G,(0,d.jsx)(_,{children:(0,d.jsxs)(W,{alignItems:"center",p:"10px",children:[(0,d.jsx)(A,{$color:O.color}),(0,d.jsx)(x.Z,{children:O.label}),(0,d.jsx)(m.Z,{})]})})]}):null}},11885:function(n,r,e){e.d(r,{X:function(){return l},a:function(){return u}});var t=e(50930),o=e(57535),c=e(2784),i=e(3255),a=e(15112),s=[];function u(n,r){var e=(0,a.g)().chainId,u=(0,i.ZP)(e&&[o.sR,"blockNumber",e]).data,l=void 0===u?0:u;(0,c.useEffect)(n.bind(null,l),[l].concat((0,t.Z)(r||s)))}function l(n,r){var e=(0,a.g)().chainId,u=(0,i.ZP)(e&&[o.KI,"blockNumber",e]).data,l=void 0===u?0:u;(0,c.useEffect)(n.bind(null,l),[l].concat((0,t.Z)(r||s)))}},80751:function(n,r,e){e.d(r,{Z:function(){return k}});var t=e(70865),o=e(96670),c=e(26297),i=e(52322);e(2784);var a=e(92228),s=e(3411),u=e(78545),l=e(26074),d=e(5406);function h(){var n=(0,a.Z)(["\n      animation: "," 3s ease infinite;\n      background-size: 400% 400%;\n    "]);return h=function(){return n},n}function f(){var n=(0,a.Z)(["\n  background: ",";\n  border-radius: ",";\n  color: ",";\n  overflow: hidden;\n  position: relative;\n\n  ","\n\n  padding: 1px 1px 3px 1px;\n\n  ","\n"]);return f=function(){return n},n}function b(){var n=(0,a.Z)(["\n  width: 100%;\n  height: 100%;\n  overflow: ",";\n  background: ",";\n  border-radius: ",";\n"]);return b=function(){return n},n}var p=s.ZP.div.withConfig({componentId:"sc-69ac18f9-0"})(f(),function(n){var r=n.isActive,e=n.isSuccess,t=n.isWarning,o=n.borderBackground,c=n.theme;return o||(t?c.colors.warning:e?c.colors.success:r?"linear-gradient(180deg, ".concat(c.colors.primaryBright,", ").concat(c.colors.secondary,")"):c.colors.cardBorder)},function(n){return n.theme.radii.card},function(n){var r=n.theme,e=n.isDisabled;return r.colors[e?"textDisabled":"text"]},function(n){return n.isActive&&(0,s.iv)(h(),l.DS)},u.Dh),g=(0,s.ZP)(d.ZP).withConfig({componentId:"sc-69ac18f9-1"})(b(),function(n){return n.hasCustomBorder?"initial":"inherit"},function(n){var r=n.theme,e=n.background;return null!=e?e:r.card.background},function(n){return n.theme.radii.card});p.defaultProps={isActive:!1,isSuccess:!1,isWarning:!1,isDisabled:!1};var k=function(n){var r=n.ribbon,e=n.children,a=n.background,s=(0,c.Z)(n,["ribbon","children","background"]);return(0,i.jsx)(p,(0,o.Z)((0,t.Z)({},s),{children:(0,i.jsxs)(g,{background:a,hasCustomBorder:!!s.borderBackground,children:[r,e]})}))}}}]);